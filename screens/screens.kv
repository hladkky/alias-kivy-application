#:include 'widgets/widgets.kv'


<MenuScreen>:
  name: 'menu'

  MDLabel:
    text: 'test'

  FitImage:
    source: "assets/imgs/mainbackground.png"

  OutlineButton:
    text: "ГРАТИ"
    size_hint: .5, None
    pos_hint: {"center_x": .5, "center_y": .33}
    on_press: 
      root.manager.current = 'team_config'

  OutlineButton:
    text: "ПРО ГРУ"
    size_hint: .5, None
    pos_hint: {"center_x": .5, "center_y": .25}


<ConfigScreen>:
  FitImage:
    source: "assets/imgs/back.png"

  MDFloatLayout:
    size_hint: 1, 0.1
    pos_hint: {'top': 1, 'center_x': .5}
    
    BoldFontLabel:
      text: root.title
      font_size: '24sp'
      halign: 'center'
      pos_hint: {'center_x': .5, 'center_y': .5}
    
    MDSeparator:
      size_hint_x: .9
      pos_hint: {'top': 0, 'center_x': .5}
      height: '2dp'
      opacity: 1
      color: PINK_COLOR

  MDFloatLayout:
    size_hint: 1, 0.1
    pos_hint: {'top': .15, 'center_x': .5}
    
    MDFlatButton:
      size_hint: 1, 1
      pos_hint: {'top': 1, 'center_x': .5}
      ripple_color: DARK_PINK_COLOR
      on_press: root.manager.current = root.to_screen
      
      BoldFontLabel:
        text: root.button_text
        halign: 'center'
        size_hint: 1, 1
        pos_hint: {'top': 1, 'center_x': .5}
    
    MDSeparator:
      size_hint_x: .9
      pos_hint: {'top': 1, 'center_x': .5}
      height: '3dp'
      opacity: 1
      color: PINK_COLOR


<TeamConfigScreen>:
  name: 'team_config'
  
  MDFloatLayout:
    size_hint: .9, 1
    pos_hint: {'center_x': .5}

    MDList:
      size_hint: 1, 0.75
      pos_hint: {'top': .9, 'center_x': .5}
        
      MDList:
        id: team_list
        spacing: 5
      
      MDFloatLayout:
        id: add_button_container
        size_hint: 1, None
        height: root.team_height
        orientation: 'vertical'
        canvas.before:
          Color:
            rgba: 1, 1, 1, .2
          BorderImage:
            source: './assets/imgs/team_label.png'
            border: 0, 0, 0, 0
            pos: self.pos
            size: self.size
        
        MDIconButton:
          pos_hint: {'center_x': .5, 'center_y': .5}
          user_font_size: 44
          icon: 'plus-thick'
          ripple_alpha: 0
          on_press: root.add_team()
          theme_text_color: 'Custom'
          text_color: PINK_COLOR


<GameConfigScreen>:
  name: 'game_config'

  ScrollView:
    do_scroll: False, True
    size_hint: 1, .75
    pos_hint: {'top': .9, 'center_x': .5}

    MDStackLayout:
      size_hint: 1, None
      adaptive_height: True
      padding: SCREEN_PADDING

      MDStackLayout:
        id: dictionaries_label
        size_hint: .7, None
        height: 80

        FontLabel:
          text: 'Словник:'
          size_hint_y: .55
          text_size: self.size
          valign: 'bottom'

        FontLabel:
          text: root.selected_dictionary if root.selected_dictionary else 'Не вибраний'
          halign: 'left'
          font_size: 14
          size_hint_y: .45
          text_size: self.size
          valign: 'top'

      AnchorLayout:
        size_hint: .3, None
        height: 80
        center_x: .5
        center_y: .5

        MDIconButton:
          id: dictionaries_button
          icon: 'chevron-down'
          ripple_alpha: .2
          user_font_size: 44
          theme_text_color: 'Custom'
          text_color: WHITE_COLOR
          selected_color: WHITE_COLOR
          unselected_color: WHITE_COLOR
          on_press: root.show_dictionaries(self)

      MDFloatLayout:
        size_hint: 1, None
        height: 0

        DropDownLayout:
          size_hint: None, 1
          pos_hint: {'top': 1}
          width: root.width
          id: dictionaries_layout
    
      MDStackLayout:
        size_hint: .7, None
        height: 80

        FontLabel:
          text: 'Тривалість раунду:'
          size_hint_y: .55
          text_size: self.size
          valign: 'bottom'

        FontLabel:
          text: 'у секундах'
          halign: 'left'
          font_size: 14
          size_hint_y: .45
          text_size: self.size
          valign: 'top'
      
      MDBoxLayout:
        size_hint: .3, None
        height: 80

        TextButton:
          text: '-'
          size_hint: .2, .3
          font_size: 30
          on_press: root.change_round_duration(-30)

        FontLabel:
          size_hint_x: .6
          halign: 'center'
          text: str(root.round_duration)
          font_size: 30
        
        TextButton:
          text: '+'
          size_hint: .2, .3
          font_size: 30
          on_press: root.change_round_duration(+30)

      MDStackLayout:
        size_hint: .7, None
        height: 80

        FontLabel:
          text: 'Штраф за пропуск:'
          size_hint_y: .55
          text_size: self.size
          valign: 'bottom'

        FontLabel:
          text: 'мінус бал за кожне пропущене слово'
          halign: 'left'
          font_size: 14
          size_hint_y: .45
          text_size: self.size
          valign: 'top'

      AnchorLayout:
        size_hint: .3, None
        height: 80
        center_x: .5
        center_y: .5

        MDCheckbox:
          id: penalty_checkbox
          size_hint: None, None
          size: (dp(68), dp(68))
          active: True
          scale: 2
          selected_color: WHITE_COLOR
          unselected_color: WHITE_COLOR
      
      MDStackLayout:
        size_hint: .7, None
        height: 80

        FontLabel:
          text: 'Останнє слово:'
          size_hint_y: .55
          text_size: self.size
          valign: 'bottom'

        FontLabel:
          text: 'по завершенню раунду кожна команда може відгадати слово'
          halign: 'left'
          font_size: 14
          size_hint_y: .45
          text_size: self.size
          valign: 'top'

      AnchorLayout:
        size_hint: .3, None
        height: 80
        center_x: .5
        center_y: .5

        MDCheckbox:
          id: penalty_checkbox
          size_hint: None, None
          size: (dp(68), dp(68))
          active: True
          scale: 2
          selected_color: WHITE_COLOR
          unselected_color: WHITE_COLOR


<RoundScreen>:
  name: 'game'

  AnchorLayout:
    id: game_layout
    anchor_x: 'center'
    anchor_y: 'center'
    
    FloatLayout:
      FontLabel:
        id: timer
        font_size: '24sp'
        color: 159/255, 95/255, 128/255, 1
        size_hint: 1, 0.1
        pos_hint: {'center_x': 0.5, 'center_y': 0.95}
        halign: 'center'
        padding: 50, 50
        text: f'{root.time_left}'
